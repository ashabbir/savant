---
id: develop_ticket_v1
name: develop_ticket_v1
description: WF for development of a ticket
driver_version: stable
rules:
- backend-rules
- development-rules
version: 2
steps:
- id: 1
  name: fetch_ticket
  call: jira_get_issue
  input_template:
    key: "{{params.issueKey}}"
  capture_as: ticket
- id: 2
  name: checkout
  call: ci.checkout
  deps:
  - 1
  input_template:
    ref: "{{params.base_branch}}"
- id: 3
  name: feature_branch
  call: ci.create_branch
  deps:
  - 2
  input_template:
    name: "{{params.feature_branch}}"
- id: 4
  name: context_search
  call: fts_search
  deps:
  - 3
  input_template:
    q: "{{params.issueKey}}"
  capture_as: code_refs
- id: 5
  name: run_tests
  call: ci.run_tests
  deps:
  - 4
  input_template:
    ref: "{{params.feature_branch}}"
- id: 6
  name: open_pr
  call: ci.open_pr
  deps:
  - 5
  input_template:
    title: "[{{params.issueKey}}] {{params.title}}"
    base: "{{params.base_branch}}"
    head: "{{params.feature_branch}}"
