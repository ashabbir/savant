sequenceDiagram
  participant Agent as Agent Runtime (Ruby)
  participant RC as Reasoning::Client
  participant API as FastAPI
  participant Mux as Multiplexer
  participant Ctx as Context Engine
  participant DB as Postgres

  Agent->>RC: agent_intent(payload)
  RC->>API: POST /agent_intent {payload}
  API-->>RC: { tool_name | finish, tool_args, reasoning }
  RC-->>Agent: Intent
  alt tool_name present
    Agent->>Mux: tools/call(tool_name, tool_args)
    Mux->>Ctx: fts_search / other
    Ctx->>DB: FTS query
    DB-->>Ctx: rows
    Ctx-->>Mux: results
    Mux-->>Agent: results
  else finish
    Agent-->>Agent: complete session with final_text
  end

