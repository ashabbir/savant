sequenceDiagram
  participant Agent as Agent Runtime (Ruby)
  participant RC as Reasoning::Client (mongo)
  participant MQ as Mongo (reasoning_queue)
  participant QW as Reasoning Queue Worker

  Agent->>RC: agent_intent(payload, correlation_id)
  RC->>MQ: insert { type: 'agent_intent', status: 'queued' }
  RC->>MQ: poll until status=='done' or timeout
  QW->>MQ: findOneAndUpdate(status 'queued' â†’ 'processing')
  QW-->>QW: compute intent
  QW->>MQ: update { status: 'done', result }
  MQ-->>RC: document with result
  RC-->>Agent: Intent
